{"remainingRequest":"/Users/prakashthakuri/Documents/GitHub/Moasic-Chart/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/prakashthakuri/Documents/GitHub/Moasic-Chart/src/components/MosaicChart.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/prakashthakuri/Documents/GitHub/Moasic-Chart/src/components/MosaicChart.vue","mtime":1618825775772},{"path":"/Users/prakashthakuri/Documents/GitHub/Moasic-Chart/node_modules/cache-loader/dist/cjs.js","mtime":1618784450087},{"path":"/Users/prakashthakuri/Documents/GitHub/Moasic-Chart/node_modules/babel-loader/lib/index.js","mtime":1618784450018},{"path":"/Users/prakashthakuri/Documents/GitHub/Moasic-Chart/node_modules/cache-loader/dist/cjs.js","mtime":1618784450087},{"path":"/Users/prakashthakuri/Documents/GitHub/Moasic-Chart/node_modules/vue-loader/lib/index.js","mtime":1618784456613}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIGQzIGZyb20gJ2QzJzsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKCgoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJtb3NhaWMiLAogIGRhdGE6IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB7CiAgICAgIHRhYmxlSGVhZGVyOiBbCiAgICAgICAgIlF1YWxpZmllZCIsCiAgICAgICAgIk1lZXRpbmcgU2NoZWR1bGVkIiwKICAgICAgICAiT2ZmZXIiLAogICAgICAgICJOZWdvdGlhdGlvbiIsCiAgICAgICAgIkNsb3NlZCB3aW4iCiAgICAgIF0sCiAgICAgIHRhYmxlRGF0YTogewogICAgICAgIG51bWJlck9mRGVhbHM6IFsKICAgICAgICAgIDQsMyw1LDUsNQogICAgICAgIF0sCiAgICAgICAgd2VpZ2h0ZWREZWFsVmFsdWU6IFsKICAgICAgICAgIDIwMDAwLCAzMDAwMCw2MDAwMCwgIDcwMDAwLCA2MDAwMAogICAgICAgIF0sCiAgICAgICAgYXZlcmFnZURlYWxTaXplOiBbCiAgICAgICAgICAzMDAwMCwgMjUwMDAsIDIwMDAwLCAyMDAwMCwgMjAwMDAKICAgICAgICBdCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7fSwKICBtZXRob2RzOiB7CiAgICBzdW1tZWRWYWx1ZXModmFsdWVzLCBrZXkpIHsKICAgICAgaWYoa2V5ID09PSAiYXZlcmFnZURlYWxTaXplIikgcmV0dXJuIF8ubWVhbih2YWx1ZXMpOwogICAgICByZXR1cm4gXy5zdW0odmFsdWVzKTsKICAgIH0sCiAgICBnZXRLZXkoa2V5KSB7CiAgICAgIHJldHVybiBfLnVwcGVyRmlyc3QoXy5sb3dlckNhc2Uoa2V5KSk7CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgY29uc3QgY2hhcnRDb250YWluZXIgPSB0aGlzLiRyZWZzLmNoYXJ0Q29udGFpbmVyOwogICAgY29uc3Qgd2lkdGggPSBjaGFydENvbnRhaW5lci5jbGllbnRXaWR0aDsKICAgIGNvbnN0IGhlaWdodD0gNjAwOwogICAgY29uc3QgbWFyZ2luID0gewogICAgICB0b3A6IDYwLAogICAgICBib3R0b206IDIwLAogICAgICBsZWZ0OiAxODAKICAgIH07CiAgICBjb25zdCBmaWxsQ29sb3JzPSBbICIjZjBhYzEyIiwgIiNhNmE2YTYiXTsKCiAgICBkMy5qc29uKCIuL2Fzc2V0cy9kdW1teS5qc29uIikKICAgICAgLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgd2luZG93LmQzID0gZDM7CiAgICAgICAgY29uc3QgbG9jYWxlID0gZDMuZm9ybWF0TG9jYWxlKHsKICAgICAgICAgIGRlY2ltYWw6ICcuJywKICAgICAgICAgIHRob3VzYW5kczogJywnLAogICAgICAgICAgZ3JvdXBpbmc6IFszXSwKICAgICAgICAgIGN1cnJlbmN5OiBbJ+KCrCcsICcnXQogICAgICAgIH0pCiAgICAgICAgY29uc3QgZm9ybWF0ID0gbG9jYWxlLmZvcm1hdCgiJCwiKTsKICAgICAgICBjb25zdCBmaWxsQ29sb3IgPSBkID0+IGZpbGxDb2xvcnNbZF0gfHwgIiMzZDNjM2MiOwogICAgICAgIGNvbnN0IHN0cm9rZUNvbG9yID0gZCA9PiBkPjEgPyAiI2ZmZiIgOiAiIzAwMCI7CiAgICAgICAgbGV0IHhJbmRleDsKICAgICAgICBsZXQgY291bnRlciA9IDA7CgogICAgICAgIGNvbnN0IHRyZWVtYXAgPSBkYXRhID0+IGQzLnRyZWVtYXAoKQogICAgICAgICAgICAgIC5yb3VuZCh0cnVlKQogICAgICAgICAgICAgIC50aWxlKGQzLnRyZWVtYXBTbGljZURpY2UpCiAgICAgICAgICAgICAgLnNpemUoWwogICAgICAgICAgICAgICAgd2lkdGggLSBtYXJnaW4ubGVmdCwKICAgICAgICAgICAgICAgIGhlaWdodCAtIG1hcmdpbi50b3AgLSBtYXJnaW4uYm90dG9tCiAgICAgICAgICAgICAgXSkoCiAgICAgICAgICAgICAgICBkMy5oaWVyYXJjaHkoZDMuZ3JvdXAoZGF0YSwgZCA9PiBkLnR5cGUsIGQgPT4gZC5zdWJ0eXBlKSkKICAgICAgICAgICAgICAgICAgICAuc3VtKGQgPT4gZC52YWx1ZSkKICAgICAgICAgICAgICAgICAgICAuc29ydCgoYSxiKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSBhLmRlcHRoID09PSAyID8gYS52YWx1ZSAtIGIudmFsdWUgOiBiLnZhbHVlIC0gYS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWw7CgogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICkuZWFjaCggZCA9PiB7CiAgICAgICAgICAgICAgICBpZihkLngwID09PSB4SW5kZXgpIHsKICAgICAgICAgICAgICAgICAgY291bnRlcisrCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICB4SW5kZXggPSBkLngwOwogICAgICAgICAgICAgICAgICBjb3VudGVyID0gMAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZC5pID0gY291bnRlcjsKICAgICAgICAgICAgICAgIGQueDAgKz0gbWFyZ2luLmxlZnQ7CiAgICAgICAgICAgICAgICBkLngxICs9IG1hcmdpbi5sZWZ0OwogICAgICAgICAgICAgICAgZC55MCArPSBtYXJnaW4udG9wOwogICAgICAgICAgICAgICAgZC55MSArPSBtYXJnaW4udG9wOwogICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgIGNvbnN0IHJvb3QgPSB0cmVlbWFwKGRhdGEpCgogICAgICAgICAgICAgIGNvbnN0IHN2ZyA9IGQzLmNyZWF0ZSgnc3ZnJykKICAgICAgICAgICAgICAgICAgICAuYXR0cigndmlld0JveCcsIFswLDAsIHdpZHRoLCBoZWlnaHRdKQoKICAgICAgICAgICAgICBjb25zdCBub2RlID0gc3ZnLnNlbGVjdEFsbCgnZycpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kYXRhKHJvb3QuZGVzY2VuZGFudHMoKSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oJ2cnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZCA9PiBgdHJhbnNsYXRlKCR7ZC54MH0sICR7ZC55MH0pYCkKCiAgICAgICAgICAgICAgY29uc3QgY29sdW1uID0gbm9kZS5maWx0ZXIoZCA9PiBkLmxlbmd0aCA9PT0gMSk7CgogICAgICAgICAgICAgIGNvbHVtbi5hcHBlbmQoJ3RleHQnKQogICAgICAgICAgICAgIC5hdHRyKCd4JywgZCA9PiB7CiAgICAgICAgICAgICAgICByZXR1cm4gKGQueDEgLSBkLngwKSAvIDIKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIC5hdHRyKCdkeScsICctMC44ZW0nKQogICAgICAgICAgICAgIC5hdHRyKCdmaWxsJywgJyB3aGl0ZScpCiAgICAgICAgICAgICAgLnN0eWxlKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKQogICAgICAgICAgICAgIC50ZXh0KGQgPT4gZm9ybWF0KGQudmFsdWUpKTsKCiAgICAgICAgICAgICAgY29uc3QgY2VsbCA9IG5vZGUuZmlsdGVyKGQgPT4gZC5kZXB0aCA9PT0gMik7CgogICAgICAgICAgICAgICBjZWxsLmFwcGVuZCgncmVjdCcpCiAgICAgICAgICAgICAgICAuYXR0cignZmlsbCcsIGQgPT4gZmlsbENvbG9yKGQucGFyZW50LmNoaWxkcmVuLmxlbmd0aCAtIChkLmkgKyAxKSkpCiAgICAgICAgICAgICAgICAuYXR0cignd2lkdGgnLCBkID0+IGQueDEgLSBkLngwKQogICAgICAgICAgICAgICAgLmF0dHIoJ2hlaWdodCcsIGQgPT4gZC55MSAtIGQueTApCiAgICAgICAgICAgICAgICAuYXR0cignc3Ryb2tlJywgZCA9PiBzdHJva2VDb2xvcihkLnBhcmVudC5jaGlsZHJlbi5sZW5ndGggLSAoZC5pICsgMSkpKTsKCgogICAgICAgICAgICAgIGNlbGwuYXBwZW5kKCd0ZXh0JykKICAgICAgICAgICAgICAuYXR0cigneCcsIGQgPT4gKGQueDEgLSBkLngwKS8yKQogICAgICAgICAgICAgIC5hdHRyKCd5JywgZCA9PiAoZC55MSAtIGQueTApLzIpCiAgICAgICAgICAgICAgLnRleHQoZD0+IGQuZGF0YVswXSkKICAgICAgICAgICAgICAuYXR0cignZmlsbCcsIGQgPT4gc3Ryb2tlQ29sb3IoZC5wYXJlbnQuY2hpbGRyZW4ubGVuZ3RoIC0gKGQuaSArIDEpKSkKICAgICAgICAgICAgICAuc3R5bGUoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpCgogICAgICAgICAgICAgIHZhciB5U2NhbGUgPSBkMy5zY2FsZUxpbmVhcigpCiAgICAgICAgICAgICAgLnJhbmdlKFswLCBoZWlnaHQgLSBtYXJnaW4udG9wIC0gbWFyZ2luLmJvdHRvbV0pOwoKICAgICAgICAgICAgICB2YXIgeXRpY2sgPSBzdmcuc2VsZWN0QWxsKCcueScpCiAgICAgICAgICAgICAgICAuZGF0YSh5U2NhbGUudGlja3MoNSkpCiAgICAgICAgICAgICAgICAuZW50ZXIoKQogICAgICAgICAgICAgICAgLmFwcGVuZCgnZycpCiAgICAgICAgICAgICAgICAuYXR0cignY2xhc3MnLCAneScpCiAgICAgICAgICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZCA9PiAndHJhbnNsYXRlKCcgKyBtYXJnaW4ubGVmdCArJywnICsgKHlTY2FsZSgxIC0gZCkgKyBtYXJnaW4udG9wKSArICcpJyk7CiAgICAKICAgICAgICAgICAgICAgeXRpY2suYXBwZW5kKCd0ZXh0JykKICAgICAgICAgICAgICAgIC5hdHRyKCd4JywgLTgpCiAgICAgICAgICAgICAgICAuYXR0cigndGV4dC1hbmNob3InLCAnZW5kJykKICAgICAgICAgICAgICAgIC5hdHRyKCdkeScsICcuMzVlbScpCiAgICAgICAgICAgICAgICAuYXR0cignZmlsbCcsICd3aGl0ZScpCiAgICAgICAgICAgICAgICAudGV4dChkMy5mb3JtYXQoJy4wJScpKTsKICAgICAgICAgICAgICAKICAgICAgICAgICAgICBkMy5zZWxlY3QoIiNjaGFydCIpLmFwcGVuZCgoKSA9PiBzdmcubm9kZSgpKQogICAgICAgICAgICAKICAgICAgfSkKCiAgfQoKfQoK"},{"version":3,"sources":["MosaicChart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA","file":"MosaicChart.vue","sourceRoot":"src/components","sourcesContent":["\n<template>\n \n        <div class=\"container-fluid\">\n          <div class=\"row\">\n            <div class=\"col-md-10\">\n              <div id=\"chart\" ref=\"chartContainer\"></div>\n            </div>\n            <div class=\"col-md-2\">\n              <div class=\"deep-drill\">\n                <h3>Deep-drill into:</h3>\n                <ul class=\"list-group\">\n                  <li class=\"list-group-item\">Opportunities</li>\n                  <li class=\"list-group-item\">Closed win</li>\n                  <li class=\"list-group-item\">Closed lost</li>\n                </ul>\n              </div>\n            </div>\n          </div>\n          <div class=\"row\">\n            <div class=\"col-md-11\">\n              <table class=\"table table-borderless\">\n                <thead>\n                  <tr>\n                    <th></th>\n                    <th v-for=\"h in tableHeader\" :key= \"h\" class=\"text-end\">\n                      {{ h }}\n                    </th>\n                    <th></th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-for=\"(values, key) in tableData\" :key=\"key\" class=\"text-end\">\n                    <td class=\"text-start\">{{ getKey(key) }}</td>\n                    <td v-for=\"(value, i) in values\" :key=\"`${i}_${value}`\">{{ key === 'numberOfDeals' ? value : `€${value}` }}</td>\n                    <td class=\"cell--total\">{{ key === 'numberOfDeals' ? summedValues(values, key): `€${summedValues(values, key)}` }}</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n    \n</template>\n\n<script>\nimport * as d3 from 'd3';\nimport _ from 'lodash';\n\n\n\nexport default {\n  name: \"mosaic\",\n  data: function () {\n    return {\n      tableHeader: [\n        \"Qualified\",\n        \"Meeting Scheduled\",\n        \"Offer\",\n        \"Negotiation\",\n        \"Closed win\"\n      ],\n      tableData: {\n        numberOfDeals: [\n          4,3,5,5,5\n        ],\n        weightedDealValue: [\n          20000, 30000,60000,  70000, 60000\n        ],\n        averageDealSize: [\n          30000, 25000, 20000, 20000, 20000\n        ]\n      }\n    }\n  },\n  computed: {},\n  methods: {\n    summedValues(values, key) {\n      if(key === \"averageDealSize\") return _.mean(values);\n      return _.sum(values);\n    },\n    getKey(key) {\n      return _.upperFirst(_.lowerCase(key));\n    }\n  },\n  mounted() {\n    const chartContainer = this.$refs.chartContainer;\n    const width = chartContainer.clientWidth;\n    const height= 600;\n    const margin = {\n      top: 60,\n      bottom: 20,\n      left: 180\n    };\n    const fillColors= [ \"#f0ac12\", \"#a6a6a6\"];\n\n    d3.json(\"./assets/dummy.json\")\n      .then(data => {\n        window.d3 = d3;\n        const locale = d3.formatLocale({\n          decimal: '.',\n          thousands: ',',\n          grouping: [3],\n          currency: ['€', '']\n        })\n        const format = locale.format(\"$,\");\n        const fillColor = d => fillColors[d] || \"#3d3c3c\";\n        const strokeColor = d => d>1 ? \"#fff\" : \"#000\";\n        let xIndex;\n        let counter = 0;\n\n        const treemap = data => d3.treemap()\n              .round(true)\n              .tile(d3.treemapSliceDice)\n              .size([\n                width - margin.left,\n                height - margin.top - margin.bottom\n              ])(\n                d3.hierarchy(d3.group(data, d => d.type, d => d.subtype))\n                    .sum(d => d.value)\n                    .sort((a,b) => {\n                      const val = a.depth === 2 ? a.value - b.value : b.value - a.value;\n                      return val;\n\n                    })\n\n              ).each( d => {\n                if(d.x0 === xIndex) {\n                  counter++\n                } else {\n                  xIndex = d.x0;\n                  counter = 0\n                }\n                d.i = counter;\n                d.x0 += margin.left;\n                d.x1 += margin.left;\n                d.y0 += margin.top;\n                d.y1 += margin.top;\n              })\n\n              const root = treemap(data)\n\n              const svg = d3.create('svg')\n                    .attr('viewBox', [0,0, width, height])\n\n              const node = svg.selectAll('g')\n                              .data(root.descendants())\n                              .join('g')\n                              .attr('transform', d => `translate(${d.x0}, ${d.y0})`)\n\n              const column = node.filter(d => d.length === 1);\n\n              column.append('text')\n              .attr('x', d => {\n                return (d.x1 - d.x0) / 2\n              })\n              .attr('dy', '-0.8em')\n              .attr('fill', ' white')\n              .style('text-anchor', 'middle')\n              .text(d => format(d.value));\n\n              const cell = node.filter(d => d.depth === 2);\n\n               cell.append('rect')\n                .attr('fill', d => fillColor(d.parent.children.length - (d.i + 1)))\n                .attr('width', d => d.x1 - d.x0)\n                .attr('height', d => d.y1 - d.y0)\n                .attr('stroke', d => strokeColor(d.parent.children.length - (d.i + 1)));\n\n\n              cell.append('text')\n              .attr('x', d => (d.x1 - d.x0)/2)\n              .attr('y', d => (d.y1 - d.y0)/2)\n              .text(d=> d.data[0])\n              .attr('fill', d => strokeColor(d.parent.children.length - (d.i + 1)))\n              .style('text-anchor', 'middle')\n\n              var yScale = d3.scaleLinear()\n              .range([0, height - margin.top - margin.bottom]);\n\n              var ytick = svg.selectAll('.y')\n                .data(yScale.ticks(5))\n                .enter()\n                .append('g')\n                .attr('class', 'y')\n                .attr('transform', d => 'translate(' + margin.left +',' + (yScale(1 - d) + margin.top) + ')');\n    \n               ytick.append('text')\n                .attr('x', -8)\n                .attr('text-anchor', 'end')\n                .attr('dy', '.35em')\n                .attr('fill', 'white')\n                .text(d3.format('.0%'));\n              \n              d3.select(\"#chart\").append(() => svg.node())\n            \n      })\n\n  }\n\n}\n\n</script>\n\n\n<style>\n\n.table {\n  color: white;\n}\n\n.cell--total {\n  font-weight: 600;\n  color: #f0ac12;\n}\n\ndiv.deep-drill {\n  margin-top: 20px;\n}\n\n.deep-drill > h3 {\n  border-bottom: 3px dotted #f0ac12;\n}\n\n.list-group-item {\n  background-color: #323236;\n  color: white;\n  border: 2px dashed white !important;\n  margin: 5px;\n  padding: 12px;\n}\n\n</style>"]}]}